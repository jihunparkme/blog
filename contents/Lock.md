# Lock

## Database Lock

여러 사용자나 프로세스가 동시에 데이터를 액세스할 때 발생하는 데이터 무결성 문제를 방지하기 위한 메커니즘
- 데이터베이스 락은 동시성 제어의 중요한 부분
- 데이터를 일관되고 신뢰성 있게 유지하는 데 필수

### DB Lock의 주요 유형

`공유 락(Shared Lock)`

- **데이터를 읽는 작업**을 할 때 사용
- 한 자원에 대해 **여러 프로세스가 공유 락을 획득 가능** -> 다수의 사용자가 동시에 데이터를 읽을 수 있음
- 공유 락이 설정된 데이터에는 **쓰기 작업** 불가

`배타 락(Exclusive Lock)`

- **데이터에 쓰기 작업**을 할 때 사용
- 배타 락이 설정된 자원은 해당 락을 보유한 **단 하나의 트랜잭션만이 데이터를 수정** 가능
- 다른 어떤 락도 **해당 자원에 설정 불가**

### 락의 동작 방식

- `락 획득`(Acquiring a Lock): 데이터에 접근하기 전에 적절한 락을 요청하고 획득
- `락 보유`(Holding a Lock): 필요한 작업(읽기 또는 쓰기)을 수행하는 동안 락을 유지
- `락 해제`(Releasing a Lock): 작업 완료 후 락을 해제하여 다른 트랜잭션이 자원에 접근할 수 있도록

### 락의 문제점

**`데드락`(Deadlock)**

두 개 이상의 트랜잭션이 **서로의 락 해제를 무한히 기다리는 상황**
- 시스템은 데드락을 탐지하고 하나 이상의 트랜잭션을 중단시켜 문제 해결 가능

**`락 경합`(Lock Contention)**

많은 트랜잭션이 **동시에 같은 데이터에 접근**하려고 할 때 발생
- 성능 저하로 이어질 수 있으며, 락 경합을 최소화하는 설계 필요

### 락의 최적화

**락의 크기**
- 가능한 가장 작은 단위의 락을 사용하는 것을 권장(전체 테이블 락 피하기)

**락의 시간**
- 락은 가능한 짧은 시간 동안만 유지

**비관적 락과 낙관적 락**
- 필요에 따라 비관적 락(데이터를 사용하기 전에 락을 거는 방식)과 낙관적 락(실제 충돌이 일어났을 때만 대처하는 방식)을 적절히 선택
- 데이터베이스 락은 데이터의 일관성과 무결성을 유지하는 데 매우 중요하지만, 잘못 사용되면 성능 저하나 데드락 같은 문제를 유발할 수 있음










## Application Lock
## Distributed Lock