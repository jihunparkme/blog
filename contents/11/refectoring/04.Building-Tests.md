# Building-Tests

리팩토링을 하려면 먼저 **견고한 테스트가 필수**

## THE VALUE OF SELF-TESTING CODE

- 보통 코드를 작성하는데 시간을 소비하지 않고(코드 이해/설계에 사용하기도 하지만), **대부분의 경우 디버깅에 많은 시간을 소비**
- 버그를 고치는 것은 대개 빠르게 할 수 있지만, 버그를 찾는 것은 악몽
  - 하지만, 이전에 추가한 테스트들은 버그를 찾아줄 수 있다.
  - 테스트는 버그를 찾는 데 걸리는 시간을 줄여주는 강력한 버그 탐지기이다.!
- 테스트를 작성하기 가장 좋은 때는 프로그램을 작성하기 전!
- 새로운 기능을 추가할 때 테스트를 작성하는 것으로 시작하자(TDD)
  - 테스트를 작성함으로써 기능을 추가하기 위해 무엇을 해야 하는지 자문할 수 있다.
  - 테스트를 작성하는 것은 구현보다는 인터페이스에 집중할 수 있다.
  - 모든 테스트가 성공할 때, 언제 개발이 완료되는지 명확히 알 수 있다.

## Unit and Functional Tests

**유닛 테스트**

- 생산성 증대를 위해 작성
- 각 테스트는 하나의 패키지에 존재(고도로 지역화)
- 다른 패키지는 인터페이스만 테스트(mocking)
  - 그 이상은 정상적으로 동작하는 것으로 간주

**기능 테스트**

- SW가 전체적으로 잘 작동하는지 확인하기 위해 작성
- 고객에게 제공되는 품질 보장을 제공하며 개발자의 생산성과는 무관
- 버그 찾는 것을 좋아하는 팀에서 개발
- 버그를 발견했을 때 버그 수정을 위해 필요한 일
  - 버그 제거를 위한 프로덕션 코드 수정
  - 버그가 드러나는 단위 테스트 추가
- 기능 테스트도 JUnit으로 작성 가능하나 보통 GUI 기반의 도구로 작성

> [The Test Pyramid](https://martinfowler.com/articles/practical-test-pyramid.html#TheTestPyramid)

## ADDING MORE TESTS

- 클래스가 해야 하는 모든 일을 살펴보고, 모든 일에 대한 테스트를 모든 조건에 대해 추가해보자.
  - 단, 불필요한 테스트까지 모두 포함시키라는 것이 아니라 **현재나 미래에 버그를 찾아낼 수 있는 테스트를 만드는 노력**을 해보자.
  - 핵심은 잘못되었을 것이라고 예상되어 가장 걱정되는 영역을 테스트하는 것.!
- 단위 테스트는 수행되는 순서에 무관하게 동일한 결과가 나와야 한다.
- 테스트의 핵심 트릭은 **경계 조건**(boundary condition)을 찾는 것
  - **테스트를 실패하게 하는 특별한 경우**(special condition)를 찾는 것이 좋은 방법
  - 예상되는 오류가 발생하는지 반드시 확인하자.
- 테스트를 통해서 모든 버그를 찾을 수는 없지만 **리팩토링을 진행하면 프로그램을 더 잘 이해하고 더 많은 버그를 찾을 수 있다.**

## Reference

> [Ch04. Building Tests](https://www.evernote.com/shard/s3/client/snv?noteGuid=43138b92-f827-4ee9-9cf9-391331172909&noteKey=3f8220f2f4d09413&sn=https%3A%2F%2Fwww.evernote.com%2Fshard%2Fs3%2Fsh%2F43138b92-f827-4ee9-9cf9-391331172909%2F3f8220f2f4d09413&title=Ch04.%2BBuilding%2BTests)