# ëª¨ë“  íŒŒì¼ë„ ì‹œê·¸ë‹ˆì²˜ê°€ ìˆë‹¤.(íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ ìœ íš¨ì„± ê²€ì‚¬í•˜ê¸°)

ê¸°ì¡´ ë°˜í’ˆ ì‹ ì²­ ì‹œ ì´ë¯¸ì§€ë§Œ ì—…ë¡œë“œê°€ ê°€ëŠ¥í–ˆì—ˆëŠ”ë°ìš”. ì´ë²ˆì— ë™ì˜ìƒë„ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•˜ë„ë¡ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. í´ë ˆì„ ì˜ì—­ì—ì„œ ë™ì˜ìƒ ì—…ë¡œë“œ/ì¬ìƒ ë¡œì§ì„ ì‹ ê·œë¡œ êµ¬í˜„í•˜ë‹¤ ë³´ë‹ˆ ì‹ ê²½ ì¨ì•¼ í•  ìš”ì†Œë“¤ì´ ë‹¤ì†Œ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ì¤‘ì—ì„œ **íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬**ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹¤ë¤„ë³´ë ¤ê³  í•©ë‹ˆë‹¤.<br/><br/>

ì–´ëŠ ë‚  ì ì‹¬ì„ ë¨¹ìœ¼ëŸ¬ ê°€ëŠ” ê¸¸ì— íŒ€ì›ë¶„ê³¼ íŒŒì¼ ì—…ë¡œë“œ ê´€ë ¨í•˜ì—¬ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë˜ ì¤‘ íŒ€ì›ë¶„ì´ ë¬¸ë“ **"ë°”ì´ëŸ¬ìŠ¤ íŒŒì¼ì„ ì—…ë¡œë“œ ê°€ëŠ¥í•œ í™•ì¥ìë¡œ ë³€ê²½í•´ì„œ ì—…ë¡œë“œí•˜ê²Œ ë˜ë©´ ë°”ì´ëŸ¬ìŠ¤ë„ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•˜ì§€ ì•Šì„ê¹Œ?"**ë¼ëŠ” ì˜ë¬¸ì„ ê³µìœ í•´ ì£¼ì…¨ìŠµë‹ˆë‹¤. ë‹¹ì‹œì—ëŠ” "ì„¤ë§ˆ í´ë ˆì„ ì‹ ì²­ ì‹œ ë°”ì´ëŸ¬ìŠ¤ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ì‚¬ëŒì´ ìˆì„ê¹Œ?"ë¼ê³  ë‹¨ìˆœí•˜ê²Œ ìƒê°í–ˆì—ˆì§€ë§Œ, ê³„ì† ìƒê°í•˜ë‹¤ ë³´ë‹ˆ ì¶©ë¶„íˆ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì‚¬ë¡€ì˜€ìŠµë‹ˆë‹¤.<br/><br/>

ë§Œì¼ ì‹¤ì œ ì´ëŸ¬í•œ ìƒí™©ì´ ë°œìƒí•˜ë©´ ì…€ëŸ¬ëŠ” ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì‹ ë¢°ë¥¼ ìƒê²Œ ë  ìˆ˜ë„ ìˆê² ë‹¤ê³  ìƒê°í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë ‡ê²Œ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬ì— ì‚¬ìš©ë˜ëŠ” **File Signatures (aka. Magic Numbers)**ë¼ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆê³ , ì²˜ìŒ ì•Œê²Œ ëœ ì¬ë¯¸ìˆëŠ” ê°œë…ì„ í˜¼ìë§Œ ì•Œê³  ìˆê¸°ì— ì•„ê¹Œì›Œì„œ(?) ê³µìœ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. (ì•„ì´ë””ì–´ ë±…í¬ íŒ€ì›ë¶„ì—ê²Œ ê°ì‚¬ì˜ ë°•ìˆ˜ë¥¼..ğŸ‘ğŸ¼)<br/><br/>

ì°¸ê³ ë¡œ, ì´ë¯¸ì§€ ì—…ë¡œë“œ ë¡œì§ì—ì„œ ì´ë¯¸ì§€ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì´ë¯¸ í•˜ê³  ìˆì—ˆëŠ”ë°, ê·¸ëƒ¥ "ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ë¡œì§ì´êµ¬ë‚˜~!"í•˜ê³  ë¬´ì‹¬ì½” ì§€ë‚˜ê°”ë˜ ë¡œì§ì„ ì´ë²ˆ ê¸°íšŒë¥¼ í†µí•´ ë‹¤ì‹œ ë³¼ ìˆ˜ ìˆì—ˆë‹µë‹ˆë‹¤.ğŸ˜…<br/><br/>

## File Signatures

ëª¨ë“  íŒŒì¼ì€ í‘œì¤€í™”ëœ ì‹œê·¸ë‹ˆì²˜ë¥¼ ê°€ì§€ê³  ìˆëŠ”ë°, `File Signatures(aka. Magic Numbers)`ëŠ” **íŒŒì¼ì˜ í˜•íƒœë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ê³ ìœ í•œ íŒ¨í„´**ì…ë‹ˆë‹¤.<br/><br/>

ì˜ˆë¥¼ ë“¤ì–´ PNG ì´ë¯¸ì§€ íŒŒì¼ì˜ ì‹œê·¸ë‹ˆì²˜ëŠ” `89 50 4E 47 0D 0A 1A 0A`, JPEG ì´ë¯¸ì§€ íŒŒì¼ì˜ ì‹œê·¸ë‹ˆì²˜ëŠ” `FF D8 FF E0`ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</br>

íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ëŠ” ì¼ë°˜ì ìœ¼ë¡œ íŒŒì¼ì˜ ì‹œì‘ ë¶€ë¶„ì— ìœ„ì¹˜í•˜ê³ , ë°”ì´ë„ˆë¦¬ í˜•íƒœë¡œ í‘œí˜„ë©ë‹ˆë‹¤. íŒŒì¼ ë§ˆì§€ë§‰ ë¶€ë¶„ì— íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ë„ ìˆëŠ”ë° íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ì˜ ìœ„ì¹˜ì— ë”°ë¼ **í—¤ë” ì‹œê·¸ë‹ˆì²˜**(íŒŒì¼ ì‹œì‘ ë¶€ë¶„ì— ì¡´ì¬), **í‘¸í„° ì‹œê·¸ë‹ˆì²˜**(íŒŒì¼ ë§ˆì§€ë§‰ì— ì¡´ì¬)ë¼ê³  ë¶€ë¥´ê¸°ë„ í•©ë‹ˆë‹¤.</br><br/>

íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¥¼ í†µí•´ í•´ë‹¹ íŒŒì¼ì´ ì–´ë–¤ ì¢…ë¥˜ì˜ ë°ì´í„°ë¥¼ í¬í•¨í•˜ê³ , ì–´ë–¤ í¬ë§·ì„ ê°€ì¡ŒëŠ”ì§€ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ëŠ” íŒŒì¼ í¬ë§· ë¶„ì„ë¿ë§Œ ì•„ë‹ˆë¼ ì•…ì„±ì½”ë“œ ë¶„ì„, íŒŒì¼ ë³µêµ¬ ë“±ì—ë„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</br>

...<br/><br/>

íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¥¼ í†µí•´ íŒŒì¼ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê¸° ì „ì— í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•  ëª‡ ê°€ì§€ í™•ì¥ìì˜ ì‹œê·¸ë‹ˆì²˜ë¥¼ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤.</br>

### Video file

**QuickTime MPEG-4 Audio-Video (*.MP4)**

- `MPEG-4 Part 14` ë˜ëŠ” `MP4`ëŠ” ë¹„ë””ì˜¤, ì˜¤ë””ì˜¤ë¥¼ ì €ì¥í•˜ëŠ” ë° ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” í˜•ì‹
- ì¸í„°ë„·ì„ í†µí•œ ìŠ¤íŠ¸ë¦¬ë° ê°€ëŠ¥
- ê³µì‹ í™•ì¥ìëŠ” `.mp4`ì´ì§€ë§Œ ëŒ€ë¶€ë¶„ ë‹¤ë¥¸ í™•ì¥ìë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©° ì¼ë°˜ì ìœ¼ë¡œ `.m4a`, `.m4p`ê°€ ìˆë‹¤.
- QuickTime í¬ë§· ì‚¬ì–‘ ê¸°ë°˜
- ìœ íš¨ì„± ê²€ì‚¬ì—ëŠ” QuickTime Container File Typeì„ ì •ì˜í•˜ëŠ” offset 4 ì´í›„ signature ftype(hex: `66 74 79 70`)ì„ í™•ì¸í•  ì˜ˆì •ì…ë‹ˆë‹¤.
- File signature
  - MPEG-4 video file(ftypMSNV): `66 74 79 70 4D 53 4E 56`
  - ISO Base Media file(MPEG-4) (ftypisom): `66 74 79 70 69 73 6F 6D`

![ì¶œì²˜: https://www.file-recovery.com/mp4-signature-format.htm](/files/post/2024-02-20-file-signatures/mp4-signatures.png)

**Apple QuickTime Video Format (*.MOV)**

- ì• í”Œì˜ Quicktimeì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” í¬ë§·
- Macintosh, Windows í”Œë«í¼ì— ëª¨ë‘ í˜¸í™˜ë˜ëŠ” ì• í”Œì´ ê°œë°œí•œ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©
- MPEG-4ë‚˜ OGGì™€ ê°™ì€ ë‹¤ì–‘í•œ ë¹„ë””ì˜¤ ë°ì´í„° í˜•ì‹ ì €ì¥ ê°€ëŠ¥
- ìœ íš¨ì„± ê²€ì‚¬ì—ëŠ” MP4 í˜•ì‹ê³¼ ë™ì¼í•˜ê²Œ QuickTime Container File Typeì„ ì •ì˜í•˜ëŠ” offset 4 ì´í›„ signature ftype(hex: `66 74 79 70`)ì„ í™•ì¸í•  ì˜ˆì •ì…ë‹ˆë‹¤.
- File signature
  - QuickTime movie file(ftypqt): `66 74 79 70 71 74 20 20`

![ì¶œì²˜: https://www.file-recovery.com/mov-signature-format.htm](/files/post/2024-02-20-file-signatures/mov-signatures.png)

### Image file

**JPEG Image File Format (*.JPG)**

- ë””ì§€í„¸ ì´ë¯¸ì§€ë¥¼ ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì†ì‹¤ ì••ì¶• ë°©ë²•
- ì••ì¶• ì •ë„ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆì–´ ì €ì¥ í¬ê¸°ì™€ ì´ë¯¸ì§€ í’ˆì§ˆ ê°„ì˜ ì ˆì¶© ê°€ëŠ¥
- JPEG ì••ì¶•ì€ ë‹¤ì–‘í•œ ì´ë¯¸ì§€ íŒŒì¼ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©
- ì••ì¶•ëœ JPEG íŒŒì¼ì€ í•­ìƒ ë§ˆì»¤ ì½”ë“œë¡œ 16ì§„ìˆ˜ ê°’ `FF D8 FF`ë¥¼ í¬í•¨í•˜ëŠ” ì´ë¯¸ì§€ ë§ˆì»¤ë¡œ ì‹œì‘
- File signature
  - Generic JPEG Image file: `FF D8 FF ...`

![ì¶œì²˜: https://www.file-recovery.com/jpg-signature-format.htm](/files/post/2024-02-20-file-signatures/jpg-signatures.png)

**Portable Network Graphic (*.PNG)**

- ë¹„ì†ì‹¤ ê·¸ë˜í”½ íŒŒì¼ í¬ë§·ì˜ í•˜ë‚˜
- íŠ¹í—ˆ ë¬¸ì œê°€ ì–½íŒ GIF í¬ë§·ì˜ ë¬¸ì œë¥¼ í•´ê²° ë° ê°œì„ í•˜ê¸° ìœ„í•´ ê³ ì•ˆ
- PNG íŒŒì¼ì€ 8 ë°”ì´íŠ¸ì˜ ì‹œê·¸ë‹ˆì²˜(`89 50 4E 47 0D 0A 1A 0A`)ë¥¼ ê°–ëŠ”ë°, ì´ ì¤‘ `50 4E 47`ì´ ASCII ê°’ìœ¼ë¡œ PNGë¥¼ ì˜ë¯¸
- File signature
  - Portable Network Graphics file: `89 50 4E 47 0D 0A 1A 0A`

### Manipulated file

**íŒŒì¼ì˜ í™•ì¥ìë¥¼ ë³€ê²½í•œ í…ŒìŠ¤íŠ¸**
- ë°”ì´ëŸ¬ìŠ¤ê°€ ë‹´ê¸´ íŒŒì¼(zip, pkg)ì˜ í™•ì¥ìë§Œ ë³€ê²½í•˜ì—¬ íŒŒì¼ ì—…ë¡œë“œ ê²€ì¦ì„ ì‹œë„í•´ ë³´ê² ìŠµë‹ˆë‹¤.
- ì‹¤ì œë¡œ í•´ë‹¹ íŒŒì¼ì—ëŠ” ë°”ì´ëŸ¬ìŠ¤ê°€ ë‹´ê¸°ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤...ğŸ¤¥

## Validate File

### FileValidator

ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì ìš©í•´ ë³¼ íŒŒì¼ì˜ ì‹œê·¸ë‹ˆì²˜ë¥¼ ì•Œì•„ë³´ì•˜ìœ¼ë‹ˆ íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ìš© FileValidator í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë³´ì•˜ìŠµë‹ˆë‹¤.

```java
@Slf4j
public class FileValidator {
    
    /**
     * íŒŒì¼ì„ ì½ê³ , í—¤ë” ì‹œê·¸ë‹ˆì²˜(ì‹œì‘ ë¶€ë¶„ 8byte) ì •ë³´ ì¶œë ¥ ë° íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬ ë©”ì†Œë“œ í˜¸ì¶œ
     */
    public static boolean validate(String filePath) {
        String fileExtension = filePath.substring(filePath.lastIndexOf(".") + 1); // íŒŒì¼ í™•ì¥ì ì¶”ì¶œ

        try (FileInputStream fis = new FileInputStream(filePath)) {
            byte[] data = new byte[8];
            fis.read(data);

            printBytesToHex(data);
            return validateFile(fileExtension, data);
        } catch (Exception e) {
            log.error("FileValidator#validate exception." + e.getMessage(), e);
        }

        return false;
    }

    /**
     * í™•ì¥ìë³„ íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” ë©”ì†Œë“œ í˜¸ì¶œ
     */
    private static boolean validateFile(String fileExtension, byte[] data) {
        if (fileExtension.equals("mp4")) {
            return validateMP4File(data);
        } else if (fileExtension.equals("mov")) {
            return validateMOVFile(data);
        } else if (fileExtension.equals("jpeg") || fileExtension.equals("jpg")) {
            return validateJPGFile(data);
        } else if (fileExtension.equals("png")) {
            return validatePNGFile(data);
        }
        return false;
    }

    private static void printBytesToHex(byte[] bytes) {
        StringBuilder sb = new StringBuilder();
        for (byte b : bytes) {
            sb.append(String.format("%02X", b)).append(" ");
        }
        System.out.println(sb);
    }

    /**
     * PNG íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ ìœ íš¨ì„± ê²€ì‚¬
     */
    private static boolean validatePNGFile(byte[] data) {
        if ((data[1] == 0x50) && (data[2] == 0x4E) && (data[3] == 0x47)) {
            return true;
        }
        return false;
    }

    /**
     * JPG íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ ìœ íš¨ì„± ê²€ì‚¬
     */
    private static boolean validateJPGFile(byte[] data) {
        if ((data[0] == (byte) 0xFF) && (data[1] == (byte) 0xD8) && (data[2] == (byte) 0xFF)) {
            return true;
        }
        return false;
    }

    /**
     * MOV íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ ìœ íš¨ì„± ê²€ì‚¬
     */
    private static boolean validateMOVFile(byte[] data) {
        if ((data[4] == 0x66) && (data[5] == 0x74) && (data[6] == 0x79) && (data[7] == 0x70)) {
            return true;
        }
        return false;
    }

    /**
     * MP4 íŒŒì¼ ì‹œê·¸ë‹ˆì²˜ë¡œ ìœ íš¨ì„± ê²€ì‚¬
     */
    private static boolean validateMP4File(byte[] data) {
        if ((data[4] == 0x66) && (data[5] == 0x74) && (data[6] == 0x79) && (data[7] == 0x70)) {
            return true;
        }
        return false;
    }
}
```

### Test File Validate

íŒŒì¼ì˜ í—¤ë” ì‹œê·¸ë‹ˆì²˜(ì‹œì‘ ë¶€ë¶„ 8byte) offset ì •ë³´ë¥¼ ë³´ë©´ ì •ìƒì ì¸ íŒŒì¼ì€ íŒ¨í„´ì´ ë™ì¼í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- MP4: `66 74 79 70`
- MOV: `66 74 79 70`
- JPED: `FF D8 FF`
- PNG: `50 4E 47`

```java
@Test
@DisplayName("540p MP4 ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_mp4_540p_video_file() throws Exception {
    // 00 00 00 14 "66 74 79 70"
    assertTrue(FileValidator.validate("../sample/540p.mp4"));
}

@Test
@DisplayName("720p MP4 ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_mp4_720p_video_file() throws Exception {
    // 00 00 00 1C "66 74 79 70"
    assertTrue(FileValidator.validate("../sample/720p.mp4"));
}

@Test
@DisplayName("1440p MP4 ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_mp4_1440p_video_file() throws Exception {
    // 00 00 00 1C "66 74 79 70"
    assertTrue(FileValidator.validate("../sample/1440p.mp4"));
}

@Test
@DisplayName("540p MOV ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_mov_540p_video_file() throws Exception {
    // 00 00 00 14 "66 74 79 70"
    assertTrue(FileValidator.validate("../sample/540p.mov"));
}

@Test
@DisplayName("720p MOV ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_mov_720p_video_file() throws Exception {
    // 00 00 00 14 "66 74 79 70"
    assertTrue(FileValidator.validate("../sample/720p.mov"));
}

@Test
@DisplayName("1440p MOV ë¹„ë””ì˜¤ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_mov_1440p_video_file() throws Exception {
    // 00 00 00 14 "66 74 79 70"
    assertTrue(FileValidator.validate("../sample/1440p.mov"));
}

@Test
@DisplayName("JPEG ì´ë¯¸ì§€ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_jpeg_file() throws Exception {
    // "FF D8 FF" E0 00 10 4A 46
    assertTrue(FileValidator.validate("../sample/test.jpg"));
}

@Test
@DisplayName("PNG ì´ë¯¸ì§€ íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬")
public void validate_png_file() throws Exception {
    // 89 "50 4E 47" 0D 0A 1A 0A
    assertTrue(FileValidator.validate("../sample/aaa.png"));
}
```

í•˜ì§€ë§Œ, ì—…ë¡œë“œ ê°€ëŠ¥í•œ í™•ì¥ìë¡œ ë³€ê²½í•œ ë°”ì´ëŸ¬ìŠ¤ íŒŒì¼ì€ ìœ íš¨ì„± ê²€ì‚¬ì—ì„œ ì‹¤íŒ¨í•˜ê²Œ ë©ë‹ˆë‹¤. 

```java
@Test
@DisplayName("MP4ë¡œ í™•ì¥ìë§Œ ë³€ê²½í•œ ZIP íŒŒì¼ì€ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨")
public void validate_zip_to_mp4_file() throws Exception {
    // 50 4B 03 04 "14 00 08 00"
    assertFalse(FileValidator.validate("../sample/zip_file.mp4"));
}

@Test
@DisplayName("JPGë¡œ í™•ì¥ìë§Œ ë³€ê²½í•œ ZIP íŒŒì¼ì€ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨")
public void validate_zip_to_jpg_file() throws Exception {
    // "50 4B 03" 04 14 00 08 00
    assertFalse(FileValidator.validate("../sample/zip_file.jpg"));
}

@Test
@DisplayName("MOVë¡œ í™•ì¥ìë§Œ ë³€ê²½í•œ PKG íŒŒì¼ì€ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨")
public void validate_pkg_to_mov_file() throws Exception {
    // 78 61 72 21 "00 1C 00 01"
    assertFalse(FileValidator.validate("../sample/pkg_file.mov"));
}
```

íŒŒì¼ ì—…ë¡œë“œ ì‹œ ë‹¨ìˆœí•˜ê²Œ ì—…ë¡œë“œ ê°€ëŠ¥í•œ í™•ì¥ìì¸ì§€ë§Œ ê²€ì‚¬í•˜ê³  ë„˜ì–´ê°ˆ ìˆ˜ë„ ìˆì—ˆëŠ”ë°, íŒ€ì›ì˜ í˜¸ê¸°ì‹¬ ë•ë¶„ì— íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì¶”ê°€í•˜ì—¬ ì•ˆì „ì„±ì„ ë†’ì¼ ìˆ˜ ìˆì—ˆë‹µë‹ˆë‹¤.ğŸ™‡ğŸ»â€â™‚ï¸

## ë§ˆë¬´ë¦¬

ë™ì˜ìƒ ì—…ë¡œë“œ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë©´ì„œ ëª¨ë“  íŒŒì¼ì— ì‹œê·¸ë‹ˆì²˜ê°€ ìˆê³ , í•´ë‹¹ ì‹œê·¸ë‹ˆì²˜ë¡œ íŒŒì¼ ìœ íš¨ì„±ì„ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì¬ë¯¸ìˆëŠ” ì‚¬ì‹¤ì„ ì•Œê²Œ ë˜ì—ˆë˜ ì‹œê°„ì´ì—ˆë‹µë‹ˆë‹¤.<br/>
ì½ìœ¼ì‹œë©´ì„œ ê¶ê¸ˆí•˜ì‹  ì‚¬í•­ì´ë‚˜ ê°œì„  ì‚¬í•­ì´ ë³´ì´ì‹ ë‹¤ë©´ ì–¸ì œë“  ì•„ë˜ ì½”ë©˜íŠ¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.<br/>
ê¸€ì„ ì½ì–´ì£¼ì‹  ëª¨ë“  ë¶„ê»˜ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ğŸ™‡ğŸ»â€

## Reference

- [GCK'S FILE SIGNATURES TABLE](https://www.garykessler.net/library/file_sigs.html)
- [List of file signatures](https://en.wikipedia.org/wiki/List_of_file_signatures)
- [Active File Recovery](https://www.file-recovery.com/signatures.htm)
- [PNG](https://ko.wikipedia.org/wiki/PNG)